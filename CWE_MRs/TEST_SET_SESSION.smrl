import static smrl.mr.language.Operations.*;
import smrl.mr.language.Action;

package smrl.mr.test {
 
/**
 * A login operation should not succeed if performed on the HTTP channel.
 *  
 * The 1st parameter of the operator IMPLIES is a boolean expression with three clauses 
 * joined with logical conjunctions. 
 * The 1st clause checks if the current action performs a log in. 
 * The 2nd clause defines the follow-up input. 
 * The 3rd clause changes the channel of the login action in the follow-up input. 
 * 
 * The 2nd parameter of IMPLIES checks if the current action is under an encrypted channel, 
 * or the output generated by the login operation is different in the two cases.
 */
MR TEST_SET_SESSION { 
 { 
 	{
 			 var session1 = Output( Input(1), 3).session;  
 			 EQUAL( Input(2), changeCredentials( Input(1), User(2) ) )
 			 Input(2).actions.get(3).setSession(session1)
 			 
 			 Output(Input(2) , 3)
    	
	} 	
	 
 } 
}//end-MR
}//end-package





